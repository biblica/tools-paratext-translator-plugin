<?xml version="1.0"?>
<CheckAndFixItem xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Id>1f60fb2e-23d7-11eb-adc1-0242ac120002</Id>
  <Name>Put 6/em space between curly quotes</Name>
  <Description>
    Find instances of double and single “curly quotes” and add 1/6th space between them
  </Description>
  <Version>1.0.0</Version>
  <Scope>CHAPTER</Scope>
  <DefaultItemDescription>Value Found</DefaultItemDescription>
  <CheckRegex>
    ([“‘])[~\s-[\u2006]]?((\+?\w+ )?[“‘])|(’”?)[~\s-[\u2006]]?([’”])
  </CheckRegex>
  <FixRegex>
    \1\4\u2006\2\7
  </FixRegex>
  <CheckScript>
    // The check javascript
    function checkAndFix( items) {
      // A simple example that could probably be done with just regex, but...
      return items.filter(i => i[0].length === 5).map(i => ({
        MatchText: i[0].Value,
        MatchStart: i.Index,
        MatchLength: i[0].Length,
        CheckType: 'Value Found',
        FixText: i[0].Replacement,
        ResultState: 'Found'
      }))
    }
  </CheckScript>
</CheckAndFixItem>
